{% extends "dashboard/base.html" %}

{% block title %}Settings{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-8">Settings</h1>

    <!-- Messages -->
    {% if messages %}
    <div class="mb-6">
        {% for message in messages %}
        <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %} mb-2">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Integrations Section -->
    <section class="card bg-base-100 shadow-xl mb-6">
        <div class="card-body">
            <h2 class="card-title text-xl mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                </svg>
                Integrations
            </h2>

            <div class="grid gap-4 md:grid-cols-2">
                <!-- Jobber Integration -->
                <div class="border rounded-lg p-4">
                    <div class="flex items-start justify-between">
                        <div>
                            <h3 class="font-semibold text-lg">Jobber</h3>
                            <p class="text-sm text-base-content/70 mt-1">
                                Sync jobs and customer data with Jobber CRM.
                            </p>
                        </div>
                        <div class="w-10 h-10 bg-[#7CB342] rounded-lg flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                        </div>
                    </div>

                    <div class="mt-4">
                        {% if integrations.jobber %}
                        <div class="flex items-center gap-2 text-sm text-success mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            Connected{% if integrations.jobber.external_account_name %} to {{ integrations.jobber.external_account_name }}{% endif %}
                        </div>
                        <form action="{% url 'integrations:jobber_disconnect' %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline btn-error btn-sm">
                                Disconnect
                            </button>
                        </form>
                        {% else %}
                        <a href="{% url 'integrations:jobber_authorize' %}" class="btn btn-primary btn-sm">
                            Connect Jobber
                        </a>
                        {% endif %}
                    </div>
                </div>

                <!-- Cal.com Integration -->
                <div class="border rounded-lg p-4">
                    <div class="flex items-start justify-between">
                        <div>
                            <h3 class="font-semibold text-lg">Cal.com</h3>
                            <p class="text-sm text-base-content/70 mt-1">
                                Receive booking notifications and sync appointments.
                            </p>
                        </div>
                        <div class="w-10 h-10 bg-[#292929] rounded-lg flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                        </div>
                    </div>

                    <div class="mt-4">
                        {% if integrations.calcom %}
                        <div class="flex items-center gap-2 text-sm text-success mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            Webhook configured
                        </div>
                        <span class="text-sm text-base-content/60">
                            Cal.com is configured via site embed
                        </span>
                        {% else %}
                        <span class="text-sm text-base-content/60">
                            Configure Cal.com in your site settings
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}
